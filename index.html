<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PortoUniCorp | VIP Premium (Webhook Demo)</title>

    <!-- Google Identity Services -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#6366f1',
                        secondary: '#8b5cf6',
                        dark: '#1e1b4b',
                        neon: '#00f0ff',
                        cyber: '#ff00aa',
                        bronze: '#CD7F32',
                        silver: '#C0C0C0',
                        gold: '#FFD700',
                        diamond: '#9932CC'
                    },
                    fontFamily: {
                        sans: ['"Exo 2"', 'sans-serif'],
                        mono: ['"Space Mono"', 'monospace']
                    }
                }
            }
        }
    </script>

    <!-- icons/font -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Exo+2:wght@300;400;500;600;700&family=Space+Mono&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root{
            --glow-color:hsl(186,100%,50%);
            --primary:#6366f1; --secondary:#8b5cf6; --neon:#00f0ff; --cyber:#ff00aa; --dark:#1e1b4b;
            --bronze:#CD7F32; --silver:#C0C0C0; --gold:#FFD700; --diamond:#9932CC;
        }
        body{background:#0f0f15;color:#e0e0e0;font-family:Exo 2, system-ui;overflow-x:hidden}
        .cyber-glass{background:rgba(15,15,21,.7);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.08);box-shadow:0 8px 32px rgba(0,0,0,.3)}
        .cyber-card{background:linear-gradient(145deg,#161622,#1a1a28);border:1px solid rgba(98,102,241,.2);transition:.4s}
        .cyber-card:hover{transform:translateY(-8px);box-shadow:0 10px 25px rgba(98,102,241,.2)}
        .cyber-btn{background:linear-gradient(45deg,var(--primary),var(--secondary));position:relative;overflow:hidden;z-index:1}
        .notification{animation:slideIn .3s forwards, fadeOut .3s 2.7s forwards}
        @keyframes slideIn{from{transform:translateX(100%)}to{transform:translateX(0)}}
        @keyframes fadeOut{from{opacity:1}to{opacity:0}}
    </style>
</head>
<body class="font-sans">

<!-- HEADER -->
<header class="cyber-glass fixed top-0 w-full z-50">
    <div class="container mx-auto px-4 py-3 flex justify-between items-center">
        <div class="flex items-center space-x-3">
            <div class="w-10 h-10 bg-dark flex items-center justify-center rounded-lg">
                <i class="fas fa-crown text-neon text-xl"></i>
            </div>
            <h1 class="text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-neon to-cyber">PORTOUNICORP</h1>
        </div>

        <div id="authSection" class="flex items-center space-x-4">
            <div id="userProfile" class="hidden items-center space-x-2">
                <img id="userPhoto" class="w-8 h-8 rounded-full border-2 border-dark" src="" alt="User">
                <span id="userName" class="font-medium text-sm"></span>
            </div>

            <div id="googleSignInButton"></div>

            <button id="logoutButton" onclick="logout()" class="hidden cyber-btn text-white px-3 py-1 rounded text-sm font-medium">
                SAIR
            </button>
        </div>
    </div>
    <div class="h-1 bg-gradient-to-r from-primary to-cyber"></div>
</header>

<!-- MAIN -->
<main class="pt-24 pb-16">
    <!-- HERO -->
    <section id="heroSection" class="container mx-auto px-4 py-12">
        <div class="max-w-3xl mx-auto text-center">
            <h2 class="text-4xl font-bold mb-4">EXPERIÊNCIA VIP ULTIMATE</h2>
            <p class="text-gray-300 mb-6">Domine o jogo com nossos pacotes exclusivos</p>
            <div id="heroButtons" class="flex justify-center gap-4"></div>
        </div>
    </section>

    <!-- LOGIN -->
    <section id="loginSection" class="container mx-auto px-4 py-6 max-w-md">
        <div class="cyber-glass rounded-xl p-8 cyber-card text-center">
            <div class="w-20 h-20 bg-gradient-to-br from-primary to-cyber rounded-full flex items-center justify-center mx-auto mb-6">
                <i class="fas fa-user-astronaut text-white text-2xl"></i>
            </div>
            <h3 class="text-2xl font-bold mb-2">ACESSO RESTRITO</h3>
            <p class="text-gray-400 mb-4">Autentique-se para desbloquear conteúdo VIP</p>
            <div id="googleSignInButtonMain" class="flex justify-center mb-4"></div>
            <p class="text-xs text-gray-500">Ao continuar, você aceita nossos <a href="#" class="text-neon hover:underline">TERMOS QUÂNTICOS</a></p>
        </div>
    </section>

    <!-- VIP -->
    <section id="vipSection" class="hidden container mx-auto px-4 py-6">
        <!-- user card -->
        <div class="max-w-2xl mx-auto cyber-glass rounded-xl p-6 cyber-card mb-8 flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <img id="userPhotoLarge" class="w-16 h-16 rounded-full border-2 border-dark" src="" alt="User">
                <div>
                    <h3 id="userNameLarge" class="text-xl font-bold"></h3>
                    <p id="userEmail" class="text-gray-400 text-sm"></p>
                    <p class="text-xs text-gray-500 mt-1">ID: <span id="userId"></span></p>
                </div>
            </div>
            <button onclick="logout()" class="cyber-btn text-white px-4 py-2 rounded">SAIR</button>
        </div>

        <!-- plans (abbreviated) -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <!-- Bronze (example) -->
            <div class="cyber-glass p-6 rounded-lg cyber-card">
                <div class="text-center">
                    <h4 class="font-bold">BRONZE</h4>
                    <div class="text-2xl font-bold mt-2">€10 <span class="text-xs text-gray-400">/mês</span></div>
                    <ul class="text-sm text-gray-300 my-3">
                        <li>Skin Exclusiva</li>
                        <li>+50K$/ciclo</li>
                    </ul>
                    <button onclick="buyProduct('VIP Bronze', 10, 'vip')" class="w-full cyber-btn text-white py-2 rounded">ATIVAR</button>
                </div>
            </div>

            <!-- Ouro -->
            <div class="cyber-glass p-6 rounded-lg cyber-card">
                <div class="text-center">
                    <h4 class="font-bold">OURO</h4>
                    <div class="text-2xl font-bold mt-2">€50 <span class="text-xs text-gray-400">/mês</span></div>
                    <ul class="text-sm text-gray-300 my-3">
                        <li>Todos Prata +</li>
                        <li>Área VIP</li>
                    </ul>
                    <button onclick="buyProduct('VIP Ouro', 50, 'vip')" class="w-full cyber-btn text-white py-2 rounded">ATIVAR</button>
                </div>
            </div>

            <!-- Créditos -->
            <div class="cyber-glass p-6 rounded-lg cyber-card">
                <div class="text-center">
                    <h4 class="font-bold">100K CRÉDITOS</h4>
                    <div class="text-2xl font-bold mt-2">€5</div>
                    <button onclick="buyProduct('100.000 Moedas', 5, 'currency')" class="w-full cyber-btn text-white py-2 rounded">COMPRAR</button>
                </div>
            </div>

            <div class="cyber-glass p-6 rounded-lg cyber-card">
                <div class="text-center">
                    <h4 class="font-bold">5M CRÉDITOS</h4>
                    <div class="text-2xl font-bold mt-2">€150</div>
                    <button onclick="buyProduct('5.000.000 Moedas', 150, 'currency')" class="w-full cyber-btn text-white py-2 rounded">COMPRAR</button>
                </div>
            </div>
        </div>
    </section>
</main>

<!-- PURCHASE MODAL -->
<div id="purchaseModal" class="fixed inset-0 bg-black/70 hidden items-center justify-center z-50 p-4">
    <div class="cyber-glass rounded-xl max-w-md w-full p-6 cyber-card relative">
        <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-bold text-white">CONFIRMAR TRANSAÇÃO</h3>
            <button onclick="closeModal()" class="text-gray-400 hover:text-white"><i class="fas fa-times"></i></button>
        </div>

        <div id="modalContent" class="mb-4"></div>

        <label class="block text-sm text-gray-300 mb-2">MÉTODO DE PAGAMENTO</label>
        <select id="paymentMethod" class="w-full mb-4 text-white bg-dark/30 p-2 rounded">
            <option value="mbway">MBWay</option>
            <option value="paypal">PayPal</option>
            <option value="credit">Cartão</option>
            <option value="crypto">Cripto</option>
        </select>

        <div class="flex gap-2">
            <button onclick="closeModal()" class="flex-1 bg-dark/40 text-white py-2 rounded">CANCELAR</button>
            <button onclick="processPayment()" class="flex-1 cyber-btn text-white py-2 rounded">CONFIRMAR</button>
        </div>
    </div>
</div>

<!-- Footer minimal -->
<footer class="cyber-glass p-6 mt-8">
    <div class="container mx-auto text-center text-gray-400 text-xs">&copy; 2023 PORTOUNICORP</div>
</footer>

<!-- === SCRIPT PRINCIPAL (com webhook) === -->
<script>
    /************************************************************************
     * ATENÇÃO:
     * - Este exemplo coloca o WEBHOOK diretamente no front-end (inseguro).
     * - Use apenas para TESTES LOCAIS. Em produção, envie pelo BACKEND.
     ************************************************************************/

    // --------- COLOQUE O SEU WEBHOOK AQUI (fornecido por si) ----------
    const WEBHOOK_URL = "https://discord.com/api/webhooks/1389324901071978680/Fg4aYf4P4lNK-ggX_DjJTMwA6uDsqpSRqRX05m22U7NUOZ4BMJby7MvrlXgKen_IP6bs";
    // ------------------------------------------------------------------

    const appState = { user: null, currentPurchase: null, isLoggedIn: false };

    /* ---------- Função que envia para o webhook do Discord ---------- */
    async function sendWebhook(eventType, data) {
        // Monta um embed simples para o Discord
        const embed = {
            title: `Evento: ${eventType.toUpperCase()}`,
            description: data.summary || '',
            color: eventType === 'login' ? 3066993 : 15105570, // green / orange
            fields: []
        };

        // adiciona campos úteis
        if (data.user) {
            embed.fields.push({ name: 'Usuário', value: data.user.name || data.user.email || '—', inline: true });
            embed.fields.push({ name: 'Email', value: data.user.email || '—', inline: true });
            embed.fields.push({ name: 'ID', value: data.user.id ? String(data.user.id).substring(0,18) : '—', inline: true });
        }

        if (data.purchase) {
            embed.fields.push({ name: 'Produto', value: data.purchase.name || '—', inline: true });
            embed.fields.push({ name: 'Preço', value: `€${Number(data.purchase.price).toFixed(2)}`, inline: true });
            embed.fields.push({ name: 'Tipo', value: data.purchase.type || '—', inline: true });
            embed.fields.push({ name: 'Pagamento', value: data.paymentMethod || '—', inline: true });
            embed.fields.push({ name: 'Data', value: data.purchase.date || new Date().toLocaleString('pt-BR'), inline: false });
        }

        // outras info livre
        if (data.extra) {
            embed.fields.push({ name: 'Info', value: String(data.extra).substring(0,1024), inline: false });
        }

        const payload = {
            username: 'PortoUniCorp Bot',
            avatar_url: 'https://i.imgur.com/3sKQj7x.png',
            embeds: [embed]
        };

        try {
            const res = await fetch(WEBHOOK_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            // Discord responde 204 No Content em sucesso
            if (res.ok || res.status === 204) {
                console.log('Webhook enviado com sucesso', eventType);
                showNotification(`Evento "${eventType}" enviado.`, 'success');
                return true;
            } else {
                const text = await res.text();
                console.warn('Erro webhook:', res.status, text);
                showNotification(`Falha ao enviar webhook: ${res.status}`, 'error');
                return false;
            }
        } catch (err) {
            console.error('Erro ao enviar webhook (fetch):', err);
            showNotification('Erro de rede ao enviar webhook', 'error');
            return false;
        }
    }

    /* ---------- Google Identity (client-side) ---------- */
    function initializeGoogleAuth() {
        try {
            window.google.accounts.id.initialize({
                client_id: '380915385724-f4fl98kfa668bmokst5o0ga0idhjkfct.apps.googleusercontent.com',
                callback: handleGoogleLogin,
                ux_mode: 'popup',
                auto_select: false
            });

            window.google.accounts.id.renderButton(
                document.getElementById("googleSignInButton"),
                { type:"icon", theme:"filled_blue", size:"medium", shape:"circle" }
            );

            window.google.accounts.id.renderButton(
                document.getElementById("googleSignInButtonMain"),
                { type:"standard", theme:"filled_blue", size:"large", text:"signin_with", width: 300 }
            );
        } catch (e) {
            console.error('Erro init google', e);
            showNotification('Serviço de login indisponível', 'error');
        }
    }

    function parseJwt(token) {
        try {
            const base64Url = token.split('.')[1];
            const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
            return JSON.parse(atob(base64));
        } catch(e) {
            return {};
        }
    }

    async function handleGoogleLogin(response) {
        try {
            const userData = parseJwt(response.credential || '');
            const user = {
                id: userData.sub || ('unk-' + Math.random().toString(36).slice(2,10)),
                name: userData.name || userData.email || 'Usuário',
                email: userData.email || '',
                picture: userData.picture || ''
            };

            appState.user = user;
            appState.isLoggedIn = true;
            updateUI();
            showNotification(`Bem-vindo, ${user.name.split(' ')[0]}!`, 'success');

            // envia evento login para o webhook
            await sendWebhook('login', {
                user,
                summary: `${user.name} efetuou login.`,
                extra: `Token info (parcial): ${user.email ? user.email : 'sem-email'}`
            });
        } catch (err) {
            console.error('Erro no login:', err);
            showNotification('Falha na autenticação', 'error');
        }
    }

    function logout() {
        if (window.google && appState.user && appState.user.email) {
            try { google.accounts.id.disableAutoSelect(); google.accounts.id.revoke(appState.user.email, ()=>{}); } catch(e){/*ignore*/ }
        }
        appState.user = null;
        appState.isLoggedIn = false;
        updateUI();
        showNotification('Sessão encerrada', 'info');
    }

    /* ---------- Compra ---------- */
    function buyProduct(name, price, type) {
        if (!appState.isLoggedIn) {
            showNotification('Autentique-se primeiro', 'warning');
            return;
        }
        appState.currentPurchase = { name, price, type, date: new Date().toLocaleString('pt-BR') };
        showPurchaseModal();
    }

    function showPurchaseModal() {
        const modal = document.getElementById('purchaseModal');
        const modalContent = document.getElementById('modalContent');

        const p = appState.currentPurchase;
        modalContent.innerHTML = `
            <div class="text-white">
                <h4 class="font-semibold text-lg">${p.name}</h4>
                <div class="text-xl font-bold mt-2">€${Number(p.price).toFixed(2)}</div>
                <p class="text-gray-300 text-sm mt-2">Você está adquirindo: <strong>${p.name}</strong></p>
            </div>
        `;
        modal.classList.remove('hidden');
    }

    async function processPayment() {
        if (!appState.currentPurchase) return;
        const paymentMethod = document.getElementById('paymentMethod').value || 'desconhecido';

        showNotification(`Processando pagamento via ${paymentMethod}...`, 'info');

        // simulação de processamento
        setTimeout(async () => {
            showNotification(`Compra de ${appState.currentPurchase.name} confirmada!`, 'success');

            // envia webhook de compra
            await sendWebhook('purchase', {
                user: appState.user || null,
                purchase: appState.currentPurchase,
                paymentMethod,
                summary: `${appState.user ? appState.user.name : 'Anon'} comprou ${appState.currentPurchase.name} por €${Number(appState.currentPurchase.price).toFixed(2)}`
            });

            closeModal();
            appState.currentPurchase = null;
        }, 1000);
    }

    function closeModal() {
        document.getElementById('purchaseModal').classList.add('hidden');
    }

    /* ---------- UI helpers ---------- */
    function updateUI() {
        const loginSection = document.getElementById('loginSection');
        const vipSection = document.getElementById('vipSection');
        const heroButtons = document.getElementById('heroButtons');
        const userProfile = document.getElementById('userProfile');
        const userPhoto = document.getElementById('userPhoto');
        const userName = document.getElementById('userName');
        const userPhotoLarge = document.getElementById('userPhotoLarge');
        const userNameLarge = document.getElementById('userNameLarge');
        const userEmail = document.getElementById('userEmail');
        const userId = document.getElementById('userId');
        const logoutButton = document.getElementById('logoutButton');

        if (appState.isLoggedIn && appState.user) {
            if (loginSection) loginSection.classList.add('hidden');
            if (vipSection) vipSection.classList.remove('hidden');

            if (userProfile) userProfile.classList.remove('hidden');
            if (userPhoto) userPhoto.src = appState.user.picture || '';
            if (userName) userName.textContent = (appState.user.name || '').split(' ')[0] || 'Usuário';
            if (userPhotoLarge) userPhotoLarge.src = appState.user.picture || '';
            if (userNameLarge) userNameLarge.textContent = appState.user.name || '';
            if (userEmail) userEmail.textContent = appState.user.email || '';
            if (userId) userId.textContent = (appState.user.id || '').substring(0,12);
            if (logoutButton) logoutButton.classList.remove('hidden');
        } else {
            if (loginSection) loginSection.classList.remove('hidden');
            if (vipSection) vipSection.classList.add('hidden');
            if (userProfile) userProfile.classList.add('hidden');
            if (logoutButton) logoutButton.classList.add('hidden');
        }

        // hero buttons render
        if (heroButtons) {
            if (appState.isLoggedIn) {
                heroButtons.innerHTML = `
                    <button onclick="document.getElementById('vipSection').scrollIntoView({behavior:'smooth'})" class="cyber-btn text-white px-6 py-3 rounded">VER VIP</button>
                    <button onclick="document.querySelector('#vipSection > div:last-child')?.scrollIntoView({behavior:'smooth'})" class="bg-dark/40 text-white px-6 py-3 rounded border">COMPRAR CRÉDITOS</button>
                `;
            } else {
                heroButtons.innerHTML = `<button onclick="document.getElementById('loginSection').scrollIntoView({behavior:'smooth'})" class="cyber-btn text-white px-6 py-3 rounded">ACESSAR</button>`;
            }
        }
    }

    function showNotification(message, type='info') {
        const colors = {
            success: 'bg-green-500/90', warning:'bg-yellow-500/90', error:'bg-red-500/90', info:'bg-blue-500/90'
        };
        const node = document.createElement('div');
        node.className = `notification fixed bottom-4 right-4 ${colors[type] || colors.info} text-white px-4 py-2 rounded shadow-lg z-50`;
        node.innerHTML = `<i class="fas fa-${type==='success'?'check-circle':type==='warning'?'exclamation-triangle':type==='error'?'times-circle':'info-circle'} mr-2"></i><span>${message}</span>`;
        document.body.appendChild(node);
        setTimeout(()=> node.remove(), 2800);
    }

    /* ---------- inicialização ---------- */
    window.onload = function() {
        if (window.google) initializeGoogleAuth();
        else window.onGoogleLoad = initializeGoogleAuth;
        updateUI();
    };

    // expose a quick manual test (opcional)
    window.__sendManualTest = async function(){
        await sendWebhook('manual-test', { summary: 'Teste manual do webhook', extra: 'Envio direto do front-end' });
    }
</script>

</body>
            </html>
